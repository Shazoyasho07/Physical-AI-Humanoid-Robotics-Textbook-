# API Contract: RAG Chatbot for Textbook

## Query Textbook Content (RAG)

### Endpoint
`POST /api/v1/textbook/{textbook_id}/query`

### Description
Submit a question about the textbook content and receive a response generated using RAG (Retrieval-Augmented Generation) based solely on the textbook content.

### Request

#### Path Parameters
- `textbook_id` (string, required): The unique identifier of the textbook to query

#### Body Parameters
- `query` (string, required): The question or query about the textbook content
- `user_id` (string, optional): The unique identifier of the user making the query

### Response

#### Success Response (200 OK)
```json
{
  "query": "The original question asked",
  "response": "The answer generated by the RAG system",
  "sources": [
    {
      "chapter_id": "ID of the chapter used as source",
      "chapter_title": "Title of the chapter",
      "page_reference": "Page number or section where info was found"
    }
  ],
  "confidence": 0.85
}
```

#### Error Response (400 Bad Request)
```json
{
  "error": "Description of the error",
  "code": "ERROR_CODE"
}
```

#### Error Response (404 Not Found)
```json
{
  "error": "Textbook not found",
  "code": "TEXTBOOK_NOT_FOUND"
}
```

### Example Request
```http
POST /api/v1/textbook/abc123-def456/query
Content-Type: application/json

{
  "query": "Explain the fundamentals of ROS 2",
  "user_id": "user789"
}
```

### Example Response
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "query": "Explain the fundamentals of ROS 2",
  "response": "ROS 2 (Robot Operating System 2) is a flexible framework for writing robot software. It provides a collection of libraries and tools to help software developers create robot applications. Some key features include improved security, better real-time support, and quality of service settings for message passing...",
  "sources": [
    {
      "chapter_id": "ch3",
      "chapter_title": "ROS 2 Fundamentals",
      "page_reference": "Section 2.1"
    }
  ],
  "confidence": 0.92
}
```

## Get Textbook Chapters

### Endpoint
`GET /api/v1/textbook/{textbook_id}/chapters`

### Description
Retrieve the list of chapters for a specific textbook.

### Request

#### Path Parameters
- `textbook_id` (string, required): The unique identifier of the textbook

### Response

#### Success Response (200 OK)
```json
{
  "textbook_id": "The ID of the textbook",
  "chapters": [
    {
      "id": "Unique identifier for the chapter",
      "title": "Title of the chapter",
      "chapter_number": 1,
      "description": "Brief description of the chapter content"
    }
  ]
}
```

### Example Request
```http
GET /api/v1/textbook/abc123-def456/chapters
```

### Example Response
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "textbook_id": "abc123-def456",
  "chapters": [
    {
      "id": "ch1",
      "title": "Introduction to Physical AI",
      "chapter_number": 1,
      "description": "Overview of Physical AI concepts"
    },
    {
      "id": "ch2", 
      "title": "Basics of Humanoid Robotics",
      "chapter_number": 2,
      "description": "Fundamental concepts in humanoid robotics"
    }
  ]
}
```